{"version":3,"sources":["webpack:///./src/components/AppRoot.js"],"names":["params","AppRoot","props","data","console","log","window","HTMLIFrameElement","targetWindow","opener","contentWindow","postMessage","e","axios","method","url","jd_id","job_func","plc_id","work_dura","session","jdRes","responseValidate","jdResults","response","results","informOutside","jd","position_profile","setState","position","cv_id","cvRes","cvResults","cv","talent_profile","talent","res","serverResponse","error","toast","Error","trueResponse","err_msg","err_no","state","type","parsed","queryString","parse","location","search","getJD","getCV","getContent","React","Component","hot"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;CAEA;;AACA;AACA;AACA;AAEA,IAAIA,MAAM,GAAG,EAAb;;IAEMC,O;;;;;AACJ,mBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,2MAAMA,KAAN;;AADiB,8LA8BH,UAACC,IAAD,EAAU;AACxB,UAAI;AACFC,eAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBC,MAAtB;AACAF,eAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCE,iBAAjC;AACA,YAAMC,YAAY,GAAGF,MAAM,CAACG,MAAP,IAAiBF,iBAAiB,CAACG,aAAxD;AACAF,oBAAY,CAACG,WAAb,CAAyBR,IAAzB,EAA+B,GAA/B;AACD,OALD,CAKE,OAAOS,CAAP,EAAU,CACV;AACD;AACF,KAvCkB;;AAAA;AAAA;AAAA;AAAA;AAAA,2EAyCX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACcC,6CAAK,CAAC;AACxBC,sBAAM,EAAE,MADgB;AAExBC,mBAAG,EAAE,2BAFmB;AAGxBZ,oBAAI,EAAE;AACJ,4BAAU,EADN;AAEJ,6BAAW;AACT,yBAAK,EADI;AAET,yBAAK,EAFI;AAGT,yBAAK;AACH,+BAASH,MAAM,CAACgB,KADb;AAEH,kCAAYhB,MAAM,CAACiB,QAFhB;AAGH,gCAAUjB,MAAM,CAACkB,MAHd;AAIH,mCAAalB,MAAM,CAACmB,SAJjB;AAKH,iCAAWnB,MAAM,CAACoB;AALf;AAHI;AAFP;AAHkB,eAAD,CADnB;;AAAA;AACAC,mBADA;;AAoBN,oBAAKC,gBAAL,CAAsBD,KAAtB;;AAEME,uBAtBA,GAsBYF,KAAK,CAAClB,IAAN,CAAWqB,QAAX,CAAoBC,OAtBhC;;AAwBN,oBAAKC,aAAL,CAAmBH,SAAnB;;AAEAnB,qBAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBkB,SAAS,CAACI,EAA/B;AACAvB,qBAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBkB,SAAS,CAACK,gBAAhC;;AAEA,oBAAKC,QAAL,CAAc;AACZF,kBAAE,EAAEJ,SAAS,CAACI,EADF;AAEZG,wBAAQ,EAAEP,SAAS,CAACK;AAFR,eAAd;;AA7BM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAzCW;;AAAA;AAAA;AAAA;AAAA;AAAA,2EA4EX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACcf,6CAAK,CAAC;AACxBC,sBAAM,EAAE,MADgB;AAExBC,mBAAG,EAAE,yBAFmB;AAGxBZ,oBAAI,EAAE;AACJ,4BAAU,EADN;AAEJ,6BAAW;AACT,yBAAK,EADI;AAET,yBAAK,EAFI;AAGT,yBAAK;AACH,+BAASH,MAAM,CAAC+B,KADb;AAEH,iCAAW/B,MAAM,CAACoB;AAFf;AAHI;AAFP;AAHkB,eAAD,CADnB;;AAAA;AACAY,mBADA;;AAgBN,oBAAKV,gBAAL,CAAsBU,KAAtB;;AACMC,uBAjBA,GAiBYD,KAAK,CAAC7B,IAAN,CAAWqB,QAAX,CAAoBC,OAjBhC;;AAmBN,oBAAKC,aAAL,CAAmBO,SAAnB;;AAEA7B,qBAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB2B,KAAK,CAACE,EAA3B;AACA9B,qBAAO,CAACC,GAAR,CAAY,QAAZ,EAAsB2B,KAAK,CAACG,cAA5B;;AACA,oBAAKN,QAAL,CAAc;AACZK,kBAAE,EAAED,SAAS,CAACC,EADF;AAEZE,sBAAM,EAAEH,SAAS,CAACE;AAFN,eAAd;;AAvBM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA5EW;;AAAA,iMAyGA,UAACE,GAAD,EAAS;AAC1B,UAAMC,cAAc,GAAGD,GAAG,CAAClC,IAA3B;;AACA,UAAI,CAACmC,cAAL,EAAqB;AACnB,cAAKT,QAAL,CAAc;AAAEU,eAAK,EAAE;AAAT,SAAd;;AACAC,qEAAK,CAAC,WAAD,CAAL;AACA,cAAM,IAAIC,KAAJ,CAAU,WAAV,CAAN;AACD;;AACD,UAAMC,YAAY,GAAGJ,cAAc,CAACd,QAApC;;AACA,UAAI,CAACkB,YAAL,EAAmB;AACjB,cAAKb,QAAL,CAAc;AAAEU,eAAK,EAAE;AAAT,SAAd;;AACAC,qEAAK,CAAC,kBAAD,CAAL;AACA,cAAM,IAAIC,KAAJ,CAAU,kBAAV,CAAN;AACD;;AAZyB,UAalBE,OAbkB,GAaED,YAbF,CAalBC,OAbkB;AAAA,UAaTC,MAbS,GAaEF,YAbF,CAaTE,MAbS;;AAc1B,UAAIA,MAAM,KAAK,CAAf,EAAkB;AAChB,cAAKf,QAAL,CAAc;AAAEU,eAAK,EAAE;AAAT,SAAd;;AACAC,qEAAK,yDAAoBG,OAApB,EAAL;AACA,cAAM,IAAIF,KAAJ,yDAA6BE,OAA7B,EAAN;AACD;AACF,KA5HkB;;AAAA,2LA8HN,YAAM;AAAA,wBACW,MAAKE,KADhB;AAAA,UACTN,KADS,eACTA,KADS;AAAA,UACFT,QADE,eACFA,QADE;AAEjB,UAAM3B,IAAI,GAAG2B,QAAb;AAEA,UAAIS,KAAJ,EAAW,OAAO,YAAP;AACX,aAAOpC,IAAI,GAAG,2DAAC,uDAAD;AAAU,YAAI,EAAEA;AAAhB,QAAH,GAA8B,YAAzC;AACD,KApIkB;;AAEjB,UAAK0C,KAAL,GAAa;AACXlB,QAAE,EAAE,IADO;AAEXG,cAAQ,EAAE,IAFC;AAGXI,QAAE,EAAE,IAHO;AAIXE,YAAM,EAAE,IAJG;AAKXG,WAAK,EAAE;AALI,KAAb;AAFiB;AASlB;;;;wCAEmB;AAClB,UAAMO,IAAI,GAAG,EAAb;AACA,UAAMC,MAAM,GAAGC,oDAAW,CAACC,KAAZ,CAAkBC,QAAQ,CAACC,MAA3B,CAAf;AACA/C,aAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmC0C,MAAnC;AAHkB,UAIV3B,OAJU,GAI6C2B,MAJ7C,CAIV3B,OAJU;AAAA,UAIDJ,KAJC,GAI6C+B,MAJ7C,CAID/B,KAJC;AAAA,UAIMC,QAJN,GAI6C8B,MAJ7C,CAIM9B,QAJN;AAAA,UAIgBC,MAJhB,GAI6C6B,MAJ7C,CAIgB7B,MAJhB;AAAA,UAIwBC,SAJxB,GAI6C4B,MAJ7C,CAIwB5B,SAJxB;AAAA,UAImCY,KAJnC,GAI6CgB,MAJ7C,CAImChB,KAJnC;AAKlB/B,YAAM,GAAG+C,MAAT;;AAEA,UAAI/B,KAAJ,EAAW;AACT,aAAKoC,KAAL;AACA;AACD;;AACD,UAAIrB,KAAJ,EAAW;AACT,aAAKsB,KAAL;AACA;AACD;;AACD,WAAKxB,QAAL,CAAc;AAAEU,aAAK,EAAE;AAAT,OAAd;AACAC,mEAAK,CAAC,mBAAD,CAAL;AACD;;;6BA0GQ;AACP,UAAMrC,IAAI,GAAG,KAAK0C,KAAL,CAAWf,QAAxB;AAEA,aACE,wEAEG,KAAKwB,UAAL,EAFH,EAGE,2DAAC,8DAAD,OAHF,CADF;AAOD;;;;;;;;;;;EAjJmBC,4CAAK,CAACC,S;;eAoJbC,kEAAG,CAACxD,OAAD,C;;AAAH;;;;;;;;;;0BAtJXD,M;0BAEEC,O","file":"main.b47c503ef5af302f13b2.hot-update.js","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport { toast, ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { hot } from 'react-hot-loader/root';\n// import ReactJson from 'react-json-view';\nimport JSONTree from 'react-json-tree';\nimport queryString from 'query-string';\nimport './AppRoot.scss';\n\nlet params = {};\n\nclass AppRoot extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      jd: null,\n      position: null,\n      cv: null,\n      talent: null,\n      error: false\n    };\n  }\n\n  componentDidMount() {\n    const type = '';\n    const parsed = queryString.parse(location.search);\n    console.log('query string parsed', parsed);\n    const { session, jd_id, job_func, plc_id, work_dura, cv_id } = parsed;\n    params = parsed;\n\n    if (jd_id) {\n      this.getJD();\n      return;\n    }\n    if (cv_id) {\n      this.getCV();\n      return;\n    }\n    this.setState({ error: true });\n    toast('未收到 cv_id 或 jd_id');\n  }\n\n  informOutside = (data) => {\n    try {\n      console.log('window', window);\n      console.log('HTMLIFrameElement', HTMLIFrameElement);\n      const targetWindow = window.opener || HTMLIFrameElement.contentWindow;\n      targetWindow.postMessage(data, '*');\n    } catch (e) {\n      // console.error(e);\n    }\n  };\n\n  getJD = async () => {\n    const jdRes = await axios({\n      method: 'POST',\n      url: '/api/ims/profile/position',\n      data: {\n        \"header\": {},\n        \"request\": {\n          \"c\": \"\",\n          \"m\": \"\",\n          \"p\": {\n            \"jd_id\": params.jd_id,\n            \"job_func\": params.job_func,\n            \"plc_id\": params.plc_id,\n            \"work_dura\": params.work_dura,\n            \"session\": params.session\n          }\n        }\n      }\n    });\n\n    this.responseValidate(jdRes);\n\n    const jdResults = jdRes.data.response.results;\n\n    this.informOutside(jdResults);\n\n    console.log('JD 数据', jdResults.jd);\n    console.log('岗位画像数据', jdResults.position_profile);\n\n    this.setState({\n      jd: jdResults.jd,\n      position: jdResults.position_profile\n    });\n  };\n\n  getCV = async () => {\n    const cvRes = await axios({\n      method: 'POST',\n      url: '/api/ims/profile/talent',\n      data: {\n        \"header\": {},\n        \"request\": {\n          \"c\": \"\",\n          \"m\": \"\",\n          \"p\": {\n            \"cv_id\": params.cv_id,\n            \"session\": params.session\n          }\n        }\n      }\n    });\n    this.responseValidate(cvRes);\n    const cvResults = cvRes.data.response.results;\n\n    this.informOutside(cvResults);\n\n    console.log('CV 数据', cvRes.cv);\n    console.log('人才画像数据', cvRes.talent_profile);\n    this.setState({\n      cv: cvResults.cv,\n      talent: cvResults.talent_profile\n    });\n  };\n\n  responseValidate = (res) => {\n    const serverResponse = res.data;\n    if (!serverResponse) {\n      this.setState({ error: true });\n      toast('服务端响应数据为空');\n      throw new Error('服务端响应数据为空');\n    }\n    const trueResponse = serverResponse.response;\n    if (!trueResponse) {\n      this.setState({ error: true });\n      toast('响应对象无 response 域');\n      throw new Error('响应对象无 response 域')\n    }\n    const { err_msg, err_no } = trueResponse;\n    if (err_no !== 0) {\n      this.setState({ error: true });\n      toast(`服务端给出的 err_msg: ${err_msg}`);\n      throw new Error(`服务端给出的 err_msg: ${err_msg}`);\n    }\n  };\n\n  getContent = () => {\n    const { error, position } = this.state;\n    const data = position;\n\n    if (error) return '加载出错，请稍后重试';\n    return data ? <JSONTree data={data} /> : 'Loading...';\n  };\n\n  render() {\n    const data = this.state.position;\n\n    return (\n      <div>\n        {/*<ReactJson src={this.state.jd} />*/}\n        {this.getContent()}\n        <ToastContainer />\n      </div>\n    );\n  }\n}\n\nexport default hot(AppRoot);"],"sourceRoot":""}